<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="HAIP Token: Empowering AI and blockchain innovation through decentralized ecosystems." />
  <title>HAIP Token - Official Site</title>

  <!-- Perf -->
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap">
  <link rel="preload" as="image" href="images/background-cyber.jpg" imagesrcset="images/background-cyber.jpg 1200w" imagesizes="100vw">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
  <link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" rel="stylesheet" media="print" onload="this.media='all'">

  <style>
    html { scroll-behavior: smooth; overflow-x: hidden; }
    body {
      font-family: 'Orbitron', system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', Arial, sans-serif;
      background: url('images/background-cyber.jpg') no-repeat center center / cover;
      color: #f8f8f8; margin: 0; padding: 0; min-width: 100%; overflow-x: hidden;
    }
    @media (max-width: 800px){ body { background-attachment: scroll; } }

    /* FIX: lipsea clasa hidden */
    .hidden{ display:none !important; }

    header { background: rgba(31, 40, 51, 0.85); padding: 20px; text-align: center; position: relative; }
    header h1 { color: #66fcf1; margin: 0; font-size: 1.8rem; }
    .logo-fixed { position: fixed; top: 25px; left: 25px; height: 100px; z-index: 999; cursor: pointer; transition: transform 0.3s ease; }
    .logo-fixed:hover { transform: scale(1.1); }

    main {
      padding: 20px; max-width: 900px; margin: auto; background-color: rgba(15, 32, 39, 0.8);
      border-radius: 15px; box-shadow: 0 0 30px rgba(0, 255, 255, 0.2);
    }
    main > section { content-visibility: auto; contain-intrinsic-size: 600px 800px; }

    section { margin-bottom: 20px; }
    h2 { color: #45a29e; margin-bottom: 10px; font-size: 1.5rem; }
    a { color: #66fcf1; text-decoration: none; }
    .contract {
      background: #1f2833; padding: 15px 20px; border-radius: 10px; word-break: break-word; font-family: monospace;
      font-size: 0.9rem; color: #66fcf1; text-align: center; border: 1px solid #0ff0fc; box-shadow: 0 0 12px rgba(0, 255, 252, 0.15);
      max-width: 100%; overflow-wrap: break-word; margin-bottom: 10px;
    }
    .btn {
      background: #66fcf1; color: #0b0c10; padding: 12px 24px; border: none; border-radius: 5px; font-weight: bold;
      text-transform: uppercase; cursor: pointer; margin-top: 10px; margin-right: 10px; display: inline-block;
      transition: background 0.3s ease, transform 0.3s ease; position: relative; font-size: 1rem; min-width: 120px; touch-action: manipulation;
    }
    .btn:hover { background: #0ff0fc; transform: scale(1.05); }
    .btn:disabled { background: #4a6360; cursor: not-allowed; opacity: 0.7; }
    .btn.loading::after {
      content: ''; position: absolute; width: 16px; height: 16px; top: 50%; right: 10px; transform: translateY(-50%);
      border: 2px solid #0b0c10; border-top: 2px solid transparent; border-radius: 50%; animation: spin 1s linear infinite;
    }
    @keyframes spin { 0% { transform: translateY(-50%) rotate(0deg);} 100% { transform: translateY(-50%) rotate(360deg);} }

    .partner-logo, .future-partner-logo { transition: transform 0.4s ease, filter 0.4s ease; filter: drop-shadow(0 0 5px rgba(102, 252, 241, 0.3)); background-color: transparent; }
    .partner-logo:hover, .future-partner-logo:hover { transform: scale(1.06); filter: drop-shadow(0 0 15px #00f9ff); }

    .future-partner-logo { height: 50px; margin: 10px 20px; object-fit: contain; }
    .future-partner-logo.bybit { height: 150px; }
    .future-partner-logo.crypto-com { height: 100px; max-width: 100px; }
    .future-partner-logo.okx { height: 100px; max-width: 100px; }
    .logo-section { display: flex; flex-wrap: wrap; justify-content: center; align-items: center; gap: 20px; padding: 20px; }

    .presale-stage { background: rgba(31, 40, 51, 0.7); border-left: 4px solid #66fcf1; padding: 15px; margin-bottom: 10px; border-radius: 8px;
      box-shadow: 0 0 15px rgba(0, 249, 255, 0.1); transition: transform 0.3s ease, box-shadow 0.3s ease, background 0.3s ease; cursor: pointer; }
    .presale-stage:hover { transform: scale(1.02); box-shadow: 0 0 25px rgba(0, 249, 255, 0.3); background: rgba(31, 40, 51, 0.9); }
    .presale-stage h3 { margin-top: 0; color: #0ff0fc; font-size: 1.2rem; }
    .presale-stage p { margin: 5px 0; color: #f0f0f0; font-size: 0.9rem; }

    .countdown { text-align: center; font-size: 1.5rem; color: #0ff0fc; margin: 20px auto; font-weight: bold; text-shadow: 0 0 15px #0ff0fc;
      border: 2px solid #0ff0fc; border-radius: 10px; padding: 15px; width: fit-content; background: rgba(0, 255, 255, 0.05); }

    .newsletter-form { display: flex; flex-direction: column; gap: 10px; margin-top: 10px; }
    .newsletter-form input { padding: 10px; border: 1px solid #66fcf1; border-radius: 5px; background: #1f2833; color: #f8f8f8; width: 100%; box-sizing: border-box; }
    .newsletter-form button { background: #66fcf1; color: #0b0c10; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; }

    .token-details { display: grid; grid-template-columns: repeat(3, minmax(200px, 1fr)); gap: 15px; margin: 10px 0; }
    .token-details div { background: #1f2833; padding: 15px; border-radius: 10px; text-align: center; color: #f8f8f8; border: 2px solid #1f2833;
      transition: border-color 0.3s ease, box-shadow 0.3s ease; display: flex; flex-direction: column; align-items: center; }
    .token-details div strong { color: #66fcf1; display: block; margin-bottom: 5px; }
    .token-details div:hover { border-color: #0ff0fc; box-shadow: 0 0 15px #0ff0fc, 0 0 30px rgba(0, 255, 252, 0.5); }
    .token-details div img { max-width: 80%; height: auto; margin-top: 10px; }

    canvas#tokenomicsChart { display: block; max-width: 300px; width: 100%; margin: 0 auto; }
    .tokenomics-container .chart-legend { font-size: 1rem; text-align: center; padding: 0 10px; }
    .tokenomics-container .chart-legend p { margin: 5px 0; }

    .presale-status { font-size: 1rem; color: #f0f0f0; margin-bottom: 10px; word-break: break-word; }
    .live-status { font-size: .95rem; color: #bfefff; opacity: .9; margin-bottom: 15px; min-height: 1.2em; }
    .presale-limits { font-size: 1.1rem; color: #0ff0fc; margin-bottom: 12px; text-shadow: 0 0 10px #0ff0fc; }

    .error-msg { color: #ff8e8e; font-size: .9rem; margin: 6px auto 0; text-align: center; min-height: 1.2em; }
    .input-error { border-color: #ff6b6b !important; box-shadow: 0 0 10px rgba(255, 0, 0, 0.25); }

    .presale-input { display: flex; flex-direction: column; gap: 6px; margin-bottom: 15px; }
    .presale-input input {
      padding: 10px; border: 1px solid #66fcf1; border-radius: 5px; background: #1f2833; color: #f8f8f8; width: 100%; max-width: 300px; margin: 0 auto;
    }
    .presale-input.hidden { display: none; }

    .kv{display:grid; grid-template-columns:1fr 1fr; gap:10px}
    .kv .box{background:#152028; border:1px solid #0b2a31; border-radius:10px; padding:10px; text-align:center}
    .kv .box b{display:block; color:#66fcf1; margin-bottom:2px}
    .progress{height:12px; background:#132029; border:1px solid #0ff0fc33; border-radius:999px; overflow:hidden}
    .progress>i{display:block; height:100%; width:0%; background:linear-gradient(90deg,#66fcf1,#0ff0fc); box-shadow:0 0 14px #0ff0fc66 inset; transition:width .6s ease}

    .presale-v3{display:grid; gap:14px;}
    .presale-card{background:rgba(31,40,51,.92); border:1px solid #0ff0fc22; border-radius:14px; padding:14px; box-shadow:0 6px 24px rgba(0,249,255,.15); backdrop-filter: blur(4px);}

    @media (max-width: 600px) {
      header h1 { font-size: 1.5rem; } h2 { font-size: 1.2rem; }
      .logo-fixed { height: 80px; top: 15px; left: 15px; }
      main { padding: 15px; } .btn { padding: 10px 20px; font-size: 0.9rem; min-width: 100px; }
      .kv{grid-template-columns:1fr;}
    }

    @media (prefers-reduced-motion: reduce){
      *{ animation-duration:.001ms !important; animation-iteration-count:1 !important; transition:none !important; }
    }
  </style>
</head>
<body>
<a href="#top">
  <img src="images/haip-logo-transparent.png" alt="HAIP Logo"
       class="logo-fixed" width="220" height="220" decoding="async">
</a>

<header id="top">
  <h1>Hp Artificial Intelligence Power (HAIP)</h1>
  <p>The official BEP20 token powering AI innovation on Binance Smart Chain</p>
</header>

<main>
  <section data-aos="fade-up">
    <h2>About HAIP</h2>
    <p>HAIP is a BEP-20 token on Binance Smart Chain designed to fund and integrate artificial intelligence with decentralized finance (DeFi) and Web3 ecosystems. Leveraging smart contracts, Chainlink oracles, and IPFS storage, HAIP empowers AI-driven dApps and community governance through a decentralized DAO.</p>
    <a class="btn" href="https://pancakeswap.finance/swap?outputCurrency=0x2e5a3548a65e41e119efa48cf67bfdfc361d1a29" target="_blank" rel="noopener noreferrer">Buy on PancakeSwap</a>
    <a class="btn" href="#presale">Join Presale</a>
  </section>

  <section data-aos="fade-up">
    <h2>Token Details</h2>
    <div class="token-details">
      <div>
        <strong>Token Name</strong> Hp Artificial Intelligence Power
        <img src="images/logos/hp.png" alt="HP Logo" loading="lazy" decoding="async" width="200" height="80" style="display:block;max-width:80%;height:auto;margin:10px auto 0;">
      </div>
      <div>
        <strong>Symbol</strong> HAIP
        <img src="images/haip-logo-transparent.png" alt="HAIP Logo" loading="lazy" decoding="async" width="200" height="200" style="display:block;max-width:80%;height:auto;margin:10px auto 0;">
      </div>
      <div>
        <strong>Decimals</strong> 18
        <img src="images/haip-logo-transparent.png" alt="HAIP Logo" loading="lazy" decoding="async" width="200" height="200" style="display:block;max-width:80%;height:auto;margin:10px auto 0;">
      </div>
      <div>
        <strong>Total Supply</strong> 18,000,000,000 HAIP
        <img src="images/haip-logo-transparent.png" alt="HAIP Logo" loading="lazy" decoding="async" width="200" height="200" style="display:block;max-width:80%;height:auto;margin:10px auto 0;">
      </div>
      <div>
        <strong>Network</strong> Binance Smart Chain (BEP20)
        <img src="images/logos/bnb.png" alt="BNB Logo" loading="lazy" decoding="async" width="200" height="80" style="display:block;max-width:80%;height:auto;margin:10px auto 0;">
      </div>
      <div>
        <strong>Contract</strong>
        <div class="contract">0x2e5a3548a65e41e119efa48cf67bfdfc361d1a29</div>
        <button class="btn" onclick="copyContract()">Copy Contract</button>
      </div>
    </div>
  </section>

  <section data-aos="fade-up" class="tokenomics-section">
    <h2>Tokenomics</h2>
    <p><strong>Total Supply:</strong> 18,000,000,000 HAIP</p>
    <ul>
      <li><strong>Presale:</strong> 54% (9.72B HAIP, allocated across private and public stages)</li>
      <li><strong>DEX Liquidity:</strong> 27% (4.86B HAIP, for trading on PancakeSwap)</li>
      <li><strong>Development:</strong> 10% (1.8B HAIP, vested over 2 years)</li>
      <li><strong>Partners:</strong> 9% (1.62B HAIP, for strategic collaborations)</li>
    </ul>
    <p><strong>Vesting:</strong> Team and partner tokens vested over 2 years to ensure long-term commitment.</p>
  </section>

  <div class="tokenomics-container">
    <div class="chart-legend">
      <p><span style="color:#66fcf1;">¦</span> Presale (54%)</p>
      <p><span style="color:#0ff0fc;">¦</span> DEX Liquidity (27%)</p>
      <p><span style="color:#2c3e50;">¦</span> Development (10%)</p>
      <p><span style="color:#08fdd8;">¦</span> Partners (9%)</p>
    </div>
    <canvas id="tokenomicsChart" class="tokenomics-chart"></canvas>
  </div>

  <section data-aos="fade-up" class="roadmap-section">
    <h2>Roadmap</h2>
    <p>Updated June 2025 to reflect current development timeline.</p>
    <ul>
      <li><strong>Q3 2025:</strong> Initiation of private presale, token deployment, smart contract audits</li>
      <li><strong>Q4 2025:</strong> Public presale, TrustWallet integration, open-source code release on GitHub</li>
      <li><strong>Q1 2026:</strong> Community DAO setup, strategic partnerships with AI and DeFi projects</li>
      <li><strong>Q2 2026:</strong> AI dApp beta launch, Chainlink oracles integration</li>
      <li><strong>Q3 2026:</strong> Enhanced DAO features, pilot launch of AI model bounty marketplace</li>
      <li><strong>Q4 2026:</strong> Launchpad for AI startups funded in HAIP</li>
    </ul>
  </section>

  <section data-aos="fade-up">
    <h2>Technology Partners</h2>
    <p>We are proud to collaborate with industry leaders who support innovation and decentralized technologies.</p>
    <div style="display:flex; gap:40px; flex-wrap:wrap; align-items:center; justify-content:center;">
      <a href="https://www.hp.com" target="_blank" rel="noopener noreferrer"><img src="images/logos/hp.png" alt="HP Logo" class="partner-logo" loading="lazy" decoding="async" width="240" height="120" style="max-width:180px; margin-top:10px;"></a>
      <a href="https://ailabs.tw" target="_blank" rel="noopener noreferrer"><img src="images/logos/ai_labs.png" alt="AI Labs" class="partner-logo" loading="lazy" decoding="async" width="180" height="80" style="max-width:120px; margin-top:10px;"></a>
      <a href="https://trustwallet.com" target="_blank" rel="noopener noreferrer"><img src="images/logos/trustwallet.png" alt="Trust Wallet" class="partner-logo" loading="lazy" decoding="async" width="180" height="80" style="max-width:120px; margin-top:10px;"></a>
      <a href="https://ai.google" target="_blank" rel="noopener noreferrer"><img src="images/logos/google_ai.png" alt="Google AI" class="partner-logo" loading="lazy" decoding="async" width="220" height="100" style="max-width:160px; margin-top:10px;"></a>
      <a href="https://openai.com" target="_blank" rel="noopener noreferrer"><img src="images/logos/openai.png" alt="OpenAI" class="partner-logo" loading="lazy" decoding="async" width="200" height="90" style="max-width:140px; margin-top:10px;"></a>
      <a href="https://www.mit.edu" target="_blank" rel="noopener noreferrer"><img src="images/logos/mit.png" alt="MIT" class="partner-logo" loading="lazy" decoding="async" width="200" height="90" style="max-width:140px; margin-top:10px;"></a>
      <a href="https://pancakeswap.finance" target="_blank" rel="noopener noreferrer"><img src="images/logos/pancakeswap.png" alt="PancakeSwap" class="partner-logo" loading="lazy" decoding="async" width="190" height="90" style="max-width:130px; margin-top:10px;"></a>
      <a href="https://chain.link" target="_blank" rel="noopener noreferrer"><img src="images/logos/chainlink.png" alt="Chainlink" class="partner-logo" loading="lazy" decoding="async" width="200" height="90" style="max-width:140px; margin-top:10px;"></a>
      <a href="https://metamask.io" target="_blank" rel="noopener noreferrer"><img src="images/logos/metamask.png" alt="MetaMask" class="partner-logo" loading="lazy" decoding="async" width="200" height="90" style="max-width:140px; margin-top:10px;"></a>
    </div>
  </section>

  <section data-aos="fade-up">
    <h2 style="text-align:center; color:#66fcf1;">Future Collaboration Plan</h2>
    <p style="text-align:center;">We are excited to explore future collaborations with leading crypto exchanges to expand our ecosystem.</p>
    <div class="logo-section">
      <a href="https://www.kucoin.com" target="_blank" rel="noopener noreferrer"><img src="images/logos/kucoin.png" alt="KuCoin" class="future-partner-logo" loading="lazy" decoding="async" width="160" height="60"></a>
      <a href="https://www.kraken.com" target="_blank" rel="noopener noreferrer"><img src="images/logos/kraken.png" alt="Kraken" class="future-partner-logo" loading="lazy" decoding="async" width="160" height="60"></a>
      <a href="https://www.uphold.com" target="_blank" rel="noopener noreferrer"><img src="images/logos/uphold.png" alt="Uphold" class="future-partner-logo" loading="lazy" decoding="async" width="160" height="60"></a>
      <a href="https://www.gate.io" target="_blank" rel="noopener noreferrer"><img src="images/logos/gateio.png" alt="Gate.io" class="future-partner-logo" loading="lazy" decoding="async" width="160" height="60"></a>
      <a href="https://www.revolut.com" target="_blank" rel="noopener noreferrer"><img src="images/logos/revolut.png" alt="Revolut" class="future-partner-logo" loading="lazy" decoding="async" width="160" height="60"></a>
      <a href="https://www.bitunix.com" target="_blank" rel="noopener noreferrer"><img src="images/logos/bitunix.png" alt="Bitunix" class="future-partner-logo" loading="lazy" decoding="async" width="160" height="60"></a>
      <a href="https://www.bitfinex.com" target="_blank" rel="noopener noreferrer"><img src="images/logos/bitfinex.png" alt="Bitfinex" class="future-partner-logo" loading="lazy" decoding="async" width="160" height="60"></a>
      <a href="https://www.bybit.com" target="_blank" rel="noopener noreferrer"><img src="images/logos/bybit.png" alt="Bybit" class="future-partner-logo bybit" loading="lazy" decoding="async" width="240" height="150"></a>
      <a href="https://www.crypto.com" target="_blank" rel="noopener noreferrer"><img src="images/logos/crypto_com.png" alt="Crypto.com" class="future-partner-logo crypto-com" loading="lazy" decoding="async" width="160" height="100"></a>
      <a href="https://whitebit.com" target="_blank" rel="noopener noreferrer"><img src="images/logos/whitebit.png" alt="WhiteBIT" class="future-partner-logo" loading="lazy" decoding="async" width="160" height="60"></a>
      <a href="https://www.okx.com" target="_blank" rel="noopener noreferrer"><img src="images/logos/okx.png" alt="OKX" class="future-partner-logo okx" loading="lazy" decoding="async" width="160" height="100"></a>
      <a href="https://www.binance.com" target="_blank" rel="noopener noreferrer"><img src="images/logos/binance.png" alt="Binance" class="future-partner-logo" loading="lazy" decoding="async" width="160" height="60"></a>
    </div>
  </section>

  <section data-aos="fade-up">
    <h2>Presale Countdown</h2>
    <div class="countdown" id="countdown"></div>
  </section>

  <section data-aos="fade-up">
    <h2>Presale Stages</h2>
    <div class="presale-stage" style="animation-delay:.2s">
      <h3>Private Presale</h3>
      <p>Allocation: <strong>2% (360M HAIP)</strong></p>
      <p>Price: <strong>0.00009 USDT</strong> per HAIP</p>
      <p>Min per user: <strong>3.24 USDT</strong> (36,000 HAIP)</p>
      <p>Max per user: <strong>90 USDT</strong> (1,000,000 HAIP)</p>
    </div>
    <div class="presale-stage" style="animation-delay:.4s">
      <h3>Public Presale - Stage 1</h3>
      <p>Allocation: <strong>13% (2.34B HAIP)</strong></p>
      <p>Price: <strong>0.0036 USDT</strong> per HAIP</p>
      <p>Min per user: <strong>9.72 USDT</strong> (2,700 HAIP)</p>
      <p>Max per user: <strong>194.4 USDT</strong> (54,000 HAIP)</p>
    </div>
    <div class="presale-stage" style="animation-delay:.6s">
      <h3>Public Presale - Stage 2</h3>
      <p>Allocation: <strong>13% (2.34B HAIP)</strong></p>
      <p>Price: <strong>0.0108 USDT</strong> per HAIP</p>
      <p>Min per user: <strong>19.44 USDT</strong> (1,800 HAIP)</p>
      <p>Max per user: <strong>388.8 USDT</strong> (36,000 HAIP)</p>
    </div>
    <div class="presale-stage" style="animation-delay:.8s">
      <h3>Public Presale - Stage 3</h3>
      <p>Allocation: <strong>13% (2.34B HAIP)</strong></p>
      <p>Price: <strong>0.0324 USDT</strong> per HAIP</p>
      <p>Min per user: <strong>29.16 USDT</strong> (900 HAIP)</p>
      <p>Max per user: <strong>874.8 USDT</strong> (27,000 HAIP)</p>
    </div>
    <div class="presale-stage" style="animation-delay:1s">
      <h3>Public Presale - Stage 4</h3>
      <p>Allocation: <strong>13% (2.34B HAIP)</strong></p>
      <p>Price: <strong>0.0972 USDT</strong> per HAIP</p>
      <p>Min per user: <strong>32.36 USDT</strong> (333 HAIP)</p>
      <p>Max per user: <strong>2,361.96 USDT</strong> (24,300 HAIP)</p>
    </div>
  </section>

  <section id="presale" class="presale-v3" data-aos="fade-up" data-aos-delay="60">
    <h2>Join Presale Now</h2>

    <div class="presale-card">
      <div class="presale-head">
        <h3 class="presale-title">Private Presale</h3>
        <span class="badge-stage" id="v3StageTitle">Private</span>
      </div>
      <div class="kv" style="margin:10px 0">
        <div class="box"><b>Price</b><div id="v3StagePrice">0.00009 USDT / HAIP</div></div>
        <div class="box"><b>Your Limit (USDT)</b><div id="v3YourLimit">3.24–90.00</div></div>
        <div class="box"><b>Sold</b><div id="v3StageSold">0 / 360,000,000 HAIP</div></div>
        <div class="box"><b>Remaining</b><div id="v3StageRemaining">360,000,000 HAIP</div></div>
      </div>
      <div class="progress"><i id="v3StageProgress" style="width:0%"></i></div>
      <p class="quote" id="v3Quote">Private Presale is live. Connect your wallet to see your personalized remaining limit.</p>
    </div>

    <div class="presale-card">
      <div class="presale-status" id="presaleWalletStatus">Wallet not connected</div>
      <div class="live-status" id="gasStatus"></div>
      <div class="presale-limits" id="presaleLimits">Private Presale Limits: Min 3.24 USDT, Max 90.00 USDT · Price 0.00009 USDT/HAIP</div>

      <div class="amount-chips" id="chipsRow" style="margin:8px 0 6px">
        <button class="chip" data-usdt="25">+25</button>
        <button class="chip" data-usdt="50">+50</button>
        <button class="chip" data-usdt="75">+75</button>
        <button class="chip" data-usdt="0" data-max="1">Max</button>
      </div>

      <div class="presale-input" id="purchaseInput">
        <input type="number" id="purchaseAmount" placeholder="Amount to spend (USDT)" min="3.24" max="90" step="0.01" />
        <div id="amountError" class="error-msg"></div>
      </div>

      <div class="presale-actions" style="display:flex;justify-content:center;gap:10px;flex-wrap:wrap">
        <button class="btn" id="presaleConnectWalletBtn">Connect Wallet</button>
        <button class="btn hidden" id="presaleDisconnectWalletBtn">Disconnect Wallet</button>
        <button class="btn" id="purchaseBtn" disabled>Purchase</button>
      </div>
    </div>

    <div class="sticky-cta" id="stickyCta">
      <button class="btn" id="stickyBuyBtn">Buy HAIP</button>
    </div>
    <div class="toast" id="toast">Copied!</div>
  </section>

  <section data-aos="fade-up">
    <h2>Contact Us</h2>
    <p>Join our community or reach out for inquiries and collaborations.</p>
    <ul>
      <li>Email: <a href="mailto:contact@haip-token.org">contact@haip-token.org</a></li>
      <li>Telegram: <a href="https://t.me/haipcommunity" target="_blank" rel="noopener noreferrer">@haipcommunity</a></li>
      <li>Twitter: <a href="https://twitter.com/haiptoken" target="_blank" rel="noopener noreferrer">@haiptoken</a></li>
      <li>Discord: <a href="https://discord.gg/haip" target="_blank" rel="noopener noreferrer">HAIP Community</a></li>
    </ul>
    <div class="newsletter-form">
      <input type="email" placeholder="Enter your email for updates" required />
      <button type="submit">Subscribe</button>
    </div>
  </section>

  <section data-aos="fade-up">
    <h2>Resources</h2>
    <ul>
      <li><a href="https://bscscan.com/token/0x2e5a3548a65e41e119efa48cf67bfdfc361d1a29" target="_blank" rel="noopener noreferrer">View on BscScan</a></li>
      <li><a href="https://github.com/Darck120579/assets" target="_blank" rel="noopener noreferrer">GitHub Repository (Coming Q4 2025)</a></li>
    </ul>
  </section>

  <section data-aos="fade-up">
    <h2>Legal Disclaimer</h2>
    <p>HAIP Token is a utility token, not a security or equity in any entity. Participants must comply with local regulations before acquiring or transacting with HAIP. All smart contracts undergo independent public audits prior to deployment (Q3 2025). KYC and AML procedures are enforced for presale participants and regulated partner platforms to ensure compliance with international regulatory standards.</p>
  </section>
</main>

<!-- AOS defer -->
<script defer src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>

<script defer>
/* ===== Utils & AOS ===== */
function copyContract() {
  const contractAddress = '0x2e5a3548a65e41e119efa48cf67bfdfc361d1a29';
  navigator.clipboard.writeText(contractAddress).then(() => alert('Contract address copied to clipboard!'));
}
(function waitAOS(){
  if (window.AOS) { AOS.init({ duration: 700, once: true }); }
  else { setTimeout(waitAOS, 50); }
})();

/* ===== Countdown ===== */
const countdown = document.getElementById('countdown');
const launchDate = new Date('2025-08-01T00:00:00Z').getTime();
function updateCountdown() {
  if (!countdown) return;
  const now = Date.now(), d = launchDate - now;
  if (d <= 0) { countdown.innerHTML = "Private Presale is Live!"; return; }
  const days = Math.floor(d / 86400000);
  const hours = Math.floor((d % 86400000) / 3600000);
  const minutes = Math.floor((d % 3600000) / 60000);
  const seconds = Math.floor((d % 60000) / 1000);
  countdown.innerHTML = `${days}d ${hours}h ${minutes}m ${seconds}s`;
}
setInterval(updateCountdown, 1000); updateCountdown();

/* ===== Tokenomics: load Chart.js la vizibilitate ===== */
const tokenomicsEl = document.getElementById('tokenomicsChart');
let chartLoaded = false;
function loadChartJs(){
  return new Promise((resolve, reject)=>{
    if (window.Chart) return resolve();
    const s = document.createElement('script');
    s.src = 'https://cdn.jsdelivr.net/npm/chart.js';
    s.defer = true;
    s.onload = resolve;
    s.onerror = ()=>reject(new Error('Chart.js failed'));
    document.head.appendChild(s);
  });
}
async function onTokenomicsVisible(){
  if (chartLoaded || !tokenomicsEl) return;
  try{
    await loadChartJs(); chartLoaded = true;
    const ctx = tokenomicsEl.getContext('2d');
    new Chart(ctx, {
      type: 'doughnut',
      data: {
        labels: ['Presale (54%)', 'DEX Liquidity (27%)', 'Development (10%)', 'Partners (9%)'],
        datasets: [{ data: [54, 27, 10, 9], backgroundColor: ['#66fcf1', '#0ff0fc', '#2c3e50', '#08fdd8'], borderColor: '#0b0c10', borderWidth: 2, hoverOffset: 20 }]
      },
      options: { responsive: true, maintainAspectRatio: true, plugins: { legend: { display: false } } }
    });
  }catch(e){ console.warn(e); }
}
if ('IntersectionObserver' in window && tokenomicsEl){
  const io = new IntersectionObserver((en)=>{ if (en.some(e=>e.isIntersecting)){ onTokenomicsVisible(); io.disconnect(); }}, { rootMargin: '200px' });
  io.observe(tokenomicsEl);
} else {
  window.addEventListener('load', onTokenomicsVisible, { once: true });
}

/* ===== Presale (Private) ===== */
const presaleWalletStatus = document.getElementById('presaleWalletStatus');
const presaleConnectWalletBtn = document.getElementById('presaleConnectWalletBtn');
const presaleDisconnectWalletBtn = document.getElementById('presaleDisconnectWalletBtn');
const purchaseBtn = document.getElementById('purchaseBtn');
const purchaseInput = document.getElementById('purchaseInput');
const purchaseAmountInput = document.getElementById('purchaseAmount');
const amountError = document.getElementById('amountError');
const presaleLimits = document.getElementById('presaleLimits');
const gasStatus = document.getElementById('gasStatus');

const HAIP_ADDRESS = '0x2e5a3548a65e41e119efa48cf67bfdfc361d1a29';
const USDT_ADDRESS = '0x55d398326f99059fF775485246999027B3197955';
const PRESALE_ADDRESS = '0x07e11a90bFea0f38D203f25C26c21de1cD78bFf7';

const HAIP_ABI = [
  {"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
  {"inputs":[],"name":"decimals","outputs":[{"internalType":"uint8","name":"","type":"uint8"}],"stateMutability":"view","type":"function"}
];
const USDT_ABI = [
  {"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"spender","type":"address"}],"name":"allowance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
  {"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"approve","outputs":[{"internalType":"bool","name":"success","type":"bool"}],"stateMutability":"nonpayable","type":"function"},
  {"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
  {"inputs":[],"name":"decimals","outputs":[{"internalType":"uint8","name":"","type":"uint8"}],"stateMutability":"view","type":"function"}
];
const PRESALE_ABI = [
  {"inputs":[{"internalType":"uint256","name":"usdtAmount","type":"uint256"}],"name":"buy","outputs":[],"stateMutability":"nonpayable","type":"function"},
  {"inputs":[],"name":"currentStage","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
  {"inputs":[{"internalType":"uint256","name":"stageIdx","type":"uint256"}],"name":"getStage","outputs":[
    {"internalType":"uint256","name":"priceNum","type":"uint256"},
    {"internalType":"uint256","name":"minUsdt","type":"uint256"},
    {"internalType":"uint256","name":"maxUsdt","type":"uint256"},
    {"internalType":"uint256","name":"capTokens","type":"uint256"},
    {"internalType":"uint256","name":"soldTokens","type":"uint256"}
  ],"stateMutability":"view","type":"function"},
  {"inputs":[{"internalType":"uint256","name":"stageIdx","type":"uint256"},{"internalType":"address","name":"user","type":"address"}],"name":"maxUsdtUserCanBuy","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
  {"inputs":[{"internalType":"uint256","name":"stageIdx","type":"uint256"},{"internalType":"uint256","name":"usdtAmount","type":"uint256"}],"name":"quoteTokens","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"}
];

let web3, haipContract, usdtContract, presaleContract;
let connectedAddress = null, haipDec = 18, usdtDec = 18;

const PRIVATE_PRICE = 0.00009;
const PRIVATE_MIN   = 3.24;
const PRIVATE_MAX   = 90.00;
const PRIVATE_CAP   = 360000000;

const fmt = (n,d=2)=>Number(n).toLocaleString(undefined,{maximumFractionDigits:d});
const GOOD_BSC_RPCS = [
  'https://bsc-dataseed.binance.org',
  'https://bsc-dataseed1.ninicoin.io',
  'https://bsc.rpc.blxrbdn.com',
  'https://rpc.ankr.com/bsc'
];
const GAS_CONF = { minGwei:2.5, startGwei:3.0, maxGwei:6.0, safety:1.2, capApprove:220000, capBuy:350000 };

function toUnits(_web3, val, dec){ const bn=_web3.utils.toBN(Math.floor((+val)*1e6)); const scale=_web3.utils.toBN(10).pow(_web3.utils.toBN(dec-6)); return bn.mul(scale); }
function fromUnits(_web3, bn, dec){ const s=bn.toString(); const pad=s.padStart(dec+1,'0'); const intPart=pad.slice(0,-dec); const fracPart=pad.slice(-dec,-dec+6); return Number(`${intPart}.${fracPart}`); }

async function loadWeb3IfNeeded(){
  if (!window.Web3) {
    await new Promise((resolve, reject)=>{
      const s=document.createElement('script');
      s.src='https://cdn.jsdelivr.net/npm/web3@1.7.4/dist/web3.min.js';
      s.defer=true; s.onload=resolve; s.onerror=()=>reject(new Error('Failed to load web3'));
      document.head.appendChild(s);
    });
  }
}
async function initWeb3(){
  if (!window.Web3) return false;
  try{
    if (window.ethereum) web3 = new Web3(window.ethereum);
    else if (window.web3) web3 = new Web3(window.web3.currentProvider);
    else return false;
    haipContract = new web3.eth.Contract(HAIP_ABI, HAIP_ADDRESS);
    usdtContract = new web3.eth.Contract(USDT_ABI, USDT_ADDRESS);
    presaleContract = new web3.eth.Contract(PRESALE_ABI, PRESALE_ADDRESS);
    try{ haipDec = await haipContract.methods.decimals().call(); }catch{}
    try{ usdtDec = await usdtContract.methods.decimals().call(); }catch{}
    return true;
  }catch{ return false; }
}
async function checkNetwork(){
  try{
    const chainId = await web3.eth.getChainId();
    if (chainId !== 56) await window.ethereum.request({ method:'wallet_switchEthereumChain', params:[{ chainId:'0x38' }] });
    return true;
  }catch(switchError){
    if (switchError.code === 4902 || String(switchError.message||'').toLowerCase().includes('missing trie node')){
      await window.ethereum.request({ method:'wallet_addEthereumChain',
        params:[{ chainId:'0x38', chainName:'Binance Smart Chain', nativeCurrency:{name:'BNB',symbol:'BNB',decimals:18}, rpcUrls:GOOD_BSC_RPCS, blockExplorerUrls:['https://bscscan.com'] }]
      });
      return true;
    }
    presaleWalletStatus && (presaleWalletStatus.textContent = 'Failed to switch to Binance Smart Chain.'); return false;
  }
}
const g = (n)=>web3.utils.toWei(String(n),'gwei');
async function pickGasPriceGwei(){ try{ const netWei=await web3.eth.getGasPrice(); const netGwei=Number(web3.utils.fromWei(netWei,'gwei')); return Math.max(GAS_CONF.minGwei, Math.min(netGwei, GAS_CONF.maxGwei)); }catch{ return GAS_CONF.startGwei; } }
async function estimateGasCapped(call, from, valueWei, cap){ try{ const est=await call.estimateGas({from, value:valueWei||'0x0'}); return Math.min(Math.ceil(est*GAS_CONF.safety), cap); }catch{ return cap; } }
function isTrieError(err){ const m=String(err?.message||'').toLowerCase(); return m.includes('missing trie node')||m.includes('state node')||err?.code===-32000; }
async function sendWithLowFee(call,{from,valueWei='0x0',cap,label}){ let gasPriceGwei=await pickGasPriceGwei();
  try{ const gasLimit=await estimateGasCapped(call,from,valueWei,cap); gasStatus&&(gasStatus.textContent=`${label}… ${gasPriceGwei.toFixed(2)} gwei · gas ? ${gasLimit}`); return await call.send({from,gas:gasLimit,gasPrice:g(gasPriceGwei),value:valueWei}); }
  catch(e1){ if(isTrieError(e1)){ gasStatus&&(gasStatus.textContent='RPC node error. Switching to a healthy BSC RPC…'); try{await checkNetwork();}catch{} }
    try{ gasStatus&&(gasStatus.textContent=`${label} retry via wallet estimator…`); return await call.send({from,value:valueWei}); }
    catch(e2){ const msg=String(e2?.message||'').toLowerCase(); if(msg.includes('underpriced')||msg.includes('replacement')||msg.includes('price too low')){ gasPriceGwei=Math.min(gasPriceGwei+1.0,GAS_CONF.maxGwei); const gasLimit=await estimateGasCapped(call,from,valueWei,cap); return await call.send({from,gas:gasLimit,gasPrice:g(gasPriceGwei),value:valueWei}); } throw e2; }
  }
}

/* Validare UI */
function setError(msg){ if(!amountError||!purchaseAmountInput)return; amountError.textContent=msg||''; msg?purchaseAmountInput.classList.add('input-error'):purchaseAmountInput.classList.remove('input-error'); }
function isValidAmount(val){
  if(val===''||isNaN(val)) return false;
  const n=parseFloat(val);
  if(n<PRIVATE_MIN){ setError(`Minimum is ${PRIVATE_MIN.toFixed(2)} USDT`); return false; }
  if(n>PRIVATE_MAX){ setError(`Maximum is ${PRIVATE_MAX.toFixed(2)} USDT`); return false; }
  setError(''); return true;
}
function refreshPurchaseButtonState(){ if(!purchaseBtn) return; const ok=purchaseAmountInput&&isValidAmount(purchaseAmountInput.value); purchaseBtn.disabled = !ok || !connectedAddress; }
purchaseAmountInput && purchaseAmountInput.addEventListener('input', refreshPurchaseButtonState);

/* UI Private */
async function refreshPresaleLimits(){
  if(!presaleLimits||!purchaseAmountInput) return;
  presaleLimits.textContent = `Private Presale Limits: Min ${PRIVATE_MIN.toFixed(2)} USDT, Max ${PRIVATE_MAX.toFixed(2)} USDT · Price ${PRIVATE_PRICE.toFixed(5)} USDT/HAIP`;
  purchaseAmountInput.min = PRIVATE_MIN;
  purchaseAmountInput.max = PRIVATE_MAX;
}
async function refreshStageUI(){
  try{
    const title=document.getElementById('v3StageTitle');
    const price=document.getElementById('v3StagePrice');
    const yourLimit=document.getElementById('v3YourLimit');
    const soldEl=document.getElementById('v3StageSold');
    const remEl=document.getElementById('v3StageRemaining');
    const prog=document.getElementById('v3StageProgress');
    const quote=document.getElementById('v3Quote');

    title && (title.textContent='Private');
    price && (price.textContent=`${PRIVATE_PRICE.toFixed(5)} USDT / HAIP`);
    yourLimit && (yourLimit.textContent=`3.24–90.00`);
    quote && (quote.textContent=`Private Presale is live. Connect your wallet to see your personalized remaining limit.`);
    await refreshPresaleLimits();

    let sold=0, cap=PRIVATE_CAP; // fallback Private

    if(web3 && presaleContract){
      try{
        const idx=await presaleContract.methods.currentStage().call();
        const st=await presaleContract.methods.getStage(idx).call();
        const soldOnChain=fromUnits(web3, web3.utils.toBN(st.soldTokens||st[4]), haipDec);
        const capOnChain=fromUnits(web3, web3.utils.toBN(st.capTokens||st[3]), haipDec);
        if(capOnChain>0 && capOnChain <= PRIVATE_CAP*1.01){ sold=Math.max(0, Math.min(soldOnChain, capOnChain)); cap=capOnChain; }
      }catch{}
    }
    const remaining=Math.max(cap-sold,0);
    const pct=cap>0?Math.min((sold/cap)*100,100):0;

    soldEl && (soldEl.textContent = `${fmt(sold,2)} / ${fmt(cap,0)} HAIP`);
    remEl && (remEl.textContent = `${fmt(remaining,0)} HAIP`);
    prog && (prog.style.width = `${pct.toFixed(2)}%`);

    if (connectedAddress && web3 && presaleContract) {
      try {
        const idx=await presaleContract.methods.currentStage().call();
        const maxUser=await presaleContract.methods.maxUsdtUserCanBuy(idx, connectedAddress).call();
        const maxUserFloat=fromUnits(web3, web3.utils.toBN(maxUser), usdtDec);
        const allowed=Math.max(0, Math.min(maxUserFloat, PRIVATE_MAX));
        yourLimit && (yourLimit.textContent = `${allowed.toFixed(2)}`);
        quote && (quote.textContent = `You can still buy up to ${allowed.toFixed(2)} USDT in this stage.`);
      } catch {}
    }
  }catch{}
}
setInterval(refreshStageUI, 20000);

/* Connect/Purchase */
async function connectWallet(){
  presaleConnectWalletBtn && presaleConnectWalletBtn.classList.add('loading');
  presaleConnectWalletBtn && (presaleConnectWalletBtn.disabled = true);
  try{
    await loadWeb3IfNeeded();
    if(!await initWeb3()) throw new Error('No wallet provider detected.');
    if(!await checkNetwork()) throw new Error('Wrong network');
    const accounts = await window.ethereum.request({ method:'eth_requestAccounts' });
    if(!accounts||!accounts.length) throw new Error('No accounts authorized.');
    connectedAddress = accounts[0];

    const bal = await haipContract.methods.balanceOf(connectedAddress).call().catch(()=>0);
    presaleWalletStatus && (presaleWalletStatus.textContent = `Connected: ${connectedAddress.slice(0,6)}...${connectedAddress.slice(-4)} · Balance ${fromUnits(web3, web3.utils.toBN(bal), haipDec).toFixed(6)} HAIP`);
    presaleConnectWalletBtn && presaleConnectWalletBtn.classList.add('hidden');
    presaleDisconnectWalletBtn && presaleDisconnectWalletBtn.classList.remove('hidden');
    purchaseInput && purchaseInput.classList.remove('hidden');
    refreshPurchaseButtonState();

    window.ethereum.on('accountsChanged', ()=>location.reload());
    window.ethereum.on('chainChanged', ()=>location.reload());

    await refreshStageUI();
  }catch(error){
    presaleWalletStatus && (presaleWalletStatus.textContent = `Error: ${error.message || 'Failed to connect wallet'}`);
  }finally{
    presaleConnectWalletBtn && presaleConnectWalletBtn.classList.remove('loading');
    presaleConnectWalletBtn && (presaleConnectWalletBtn.disabled = false);
  }
}
function disconnectWallet(){
  connectedAddress = null;
  presaleWalletStatus && (presaleWalletStatus.textContent = 'Wallet not connected');
  gasStatus && (gasStatus.textContent = '');
  presaleConnectWalletBtn && presaleConnectWalletBtn.classList.remove('hidden');
  presaleDisconnectWalletBtn && presaleDisconnectWalletBtn.classList.add('hidden');
  purchaseBtn && (purchaseBtn.disabled = true);
  purchaseInput && purchaseInput.classList.add('hidden');
  purchaseAmountInput && (purchaseAmountInput.value = '');
  setError('');
  refreshStageUI();
}
async function purchaseTokens(){
  if (purchaseInput && purchaseInput.classList.contains('hidden')) { purchaseInput.classList.remove('hidden'); return; }
  if (!isValidAmount(purchaseAmountInput.value)) { refreshPurchaseButtonState(); return; }
  purchaseBtn && purchaseBtn.classList.add('loading');
  purchaseBtn && (purchaseBtn.disabled = true);
  try{
    if(!web3 || !usdtContract || !presaleContract || !connectedAddress) throw new Error('Wallet not connected');
    let usdtAmount = parseFloat(purchaseAmountInput.value);
    if (usdtAmount < PRIVATE_MIN) usdtAmount = PRIVATE_MIN;
    if (usdtAmount > PRIVATE_MAX) usdtAmount = PRIVATE_MAX;
    purchaseAmountInput.value = usdtAmount.toFixed(2);

    const idx = await presaleContract.methods.currentStage().call();
    const maxUser = await presaleContract.methods.maxUsdtUserCanBuy(idx, connectedAddress).call();
    const maxUserFloat = fromUnits(web3, web3.utils.toBN(maxUser), usdtDec);
    if (maxUserFloat <= 0) throw new Error('Your current limit is 0 USDT for this stage.');
    if (usdtAmount > maxUserFloat) {
      usdtAmount = Math.floor(maxUserFloat * 100) / 100;
      if (usdtAmount > PRIVATE_MAX) usdtAmount = PRIVATE_MAX;
      purchaseAmountInput.value = usdtAmount.toFixed(2);
      presaleWalletStatus && (presaleWalletStatus.textContent = `Amount reduced to your current limit: ${usdtAmount.toFixed(2)} USDT.`);
    }
    const usdtUnits = toUnits(web3, usdtAmount, usdtDec);

    const allowance = await usdtContract.methods.allowance(connectedAddress, PRESALE_ADDRESS).call();
    if (web3.utils.toBN(allowance).lt(usdtUnits)) {
      gasStatus && (gasStatus.textContent = 'Approving USDT…');
      await sendWithLowFee(
        usdtContract.methods.approve(PRESALE_ADDRESS, usdtUnits.toString()),
        { from: connectedAddress, cap: GAS_CONF.capApprove, label: 'Approve' }
      );
    }

    let haipAmountStr = '';
    try {
      const tokens = await presaleContract.methods.quoteTokens(idx, usdtUnits.toString()).call();
      const haipFloat = fromUnits(web3, web3.utils.toBN(tokens), haipDec);
      haipAmountStr = ` (~${haipFloat.toFixed(6)} HAIP)`;
    } catch {}

    gasStatus && (gasStatus.textContent = 'Submitting purchase…');
    const tx = await sendWithLowFee(
      presaleContract.methods.buy(usdtUnits.toString()),
      { from: connectedAddress, cap: GAS_CONF.capBuy, label: 'Buy' }
    );

    presaleWalletStatus && (presaleWalletStatus.innerHTML = `Success${haipAmountStr}! <a target="_blank" rel="noopener noreferrer" href="https://bscscan.com/tx/${tx.transactionHash}">View on BscScan</a>`);
    gasStatus && (gasStatus.textContent = 'Done.');
    purchaseInput && purchaseInput.classList.add('hidden');
    purchaseAmountInput && (purchaseAmountInput.value = '');
    setError('');
    await refreshStageUI();
  }catch(error){
    presaleWalletStatus && (presaleWalletStatus.textContent = `Error: ${error.message || 'Purchase failed'}`);
    isTrieError?.(error) && gasStatus && (gasStatus.textContent = 'Your RPC may be pruned/unstable. Switch RPC in MetaMask to: bsc-dataseed.binance.org / ankr / ninicoin.');
  }finally{
    purchaseBtn && purchaseBtn.classList.remove('loading');
    refreshPurchaseButtonState();
  }
}

/* Wire */
presaleConnectWalletBtn && presaleConnectWalletBtn.addEventListener('click', connectWallet, { passive:true });
presaleDisconnectWalletBtn && presaleDisconnectWalletBtn.addEventListener('click', disconnectWallet, { passive:true });
purchaseBtn && purchaseBtn.addEventListener('click', purchaseTokens, { passive:true });

/* Chips & sticky (lazy wire) */
(function(){
  let wired=false;
  const card=document.querySelector('#presale');
  function wire(){
    if(wired) return; wired=true;
    const chips=[...document.querySelectorAll('.chip')];
    const amountInput=document.getElementById('purchaseAmount');
    const sticky=document.getElementById('stickyCta');
    const stickyBtn=document.getElementById('stickyBuyBtn');
    chips.forEach(ch=>{
      ch.addEventListener('click', ()=>{
        chips.forEach(c=>c.classList.remove('active')); ch.classList.add('active');
        const isMax=ch.dataset.max==='1';
        let v=parseFloat(amountInput.value||'0')||0;
        if(isMax){
          let max=parseFloat((document.getElementById('v3YourLimit')?.textContent||'90').replace(/[^0-9.]/g,''))||90;
          v=Math.min(Math.max(max,3.24),90);
        } else {
          v=Math.min(Math.max(v + parseFloat(ch.dataset.usdt||'0'),3.24),90);
        }
        amountInput.value=v.toFixed(2);
        amountInput.dispatchEvent(new Event('input'));
      }, { passive:true });
    });
    function updateSticky(){ if(!sticky) return; const mq=window.matchMedia('(max-width: 740px)'); sticky.style.display = mq.matches ? 'flex' : 'none'; }
    updateSticky(); window.addEventListener('resize', updateSticky, { passive:true });
    stickyBtn && stickyBtn.addEventListener('click', ()=>{ document.getElementById('purchaseBtn')?.click(); }, { passive:true });
  }
  if(card && 'IntersectionObserver' in window){
    const io=new IntersectionObserver((e)=>{ if(e[0].isIntersecting){ wire(); io.disconnect(); }}, {rootMargin:'200px'});
    io.observe(card);
  } else { wire(); }
})();

/* Init */
(async()=>{ try{ await refreshStageUI(); refreshPurchaseButtonState(); }catch{} })();
</script>
</body>
</html>
